# tz-player Implementation TODO

Execution tracker derived from `SPEC.md`.
`SPEC.md` remains the source of truth.
Please see `AGENTS.md` for more instructions.

## Status Legend

- `todo`: not started
- `in_progress`: actively being worked
- `done`: implemented, validated, and committed
- `blocked`: requires decision or external dependency
- `deferred`: intentionally postponed by project decision

## Active Backlog

### T-050 Analysis Pipeline Consolidation + Read-Path Write Elimination
- Spec Ref: Section `5` (analysis/service model), Section `7` (persistence), Section `8` (non-blocking reliability), `WF-06`
- Status: `in_progress`
- Goal:
  - Reduce analysis-path contention and duplicate decode cost by removing hot-path cache writes during frame sampling and consolidating multi-analysis decode work into one pass.
- Scope:
  - Stop per-sample `last_accessed_at` writes from scalar/spectrum/beat/waveform read paths; retain retention correctness via throttled/batched touch semantics.
  - Add a shared decode/analysis pipeline that computes spectrum + beat + waveform outputs from one decoded PCM pass per track/parameter set.
  - Keep lazy cache scheduling behavior and plugin capability gating unchanged.
- Non-goals:
  - Replacing SQLite-backed analysis cache architecture.
  - Changing visualizer plugin contracts or capability flags.
  - Adding live backend PCM extraction in this task.
- Tasks:
  - `T-050A` Remove per-sample `last_accessed_at` updates from hot read paths. Status: `in_progress`
    - Refactor stores so `get_*_at(...)` does not issue write statements per playback poll sample.
    - Introduce bounded access-touch updates that preserve pruning usefulness without high-frequency lock contention.
    - Add regression coverage validating read-path lookups remain write-free and cache/prune metadata still updates on bounded cadence.
  - `T-050B` Shared decode pipeline for spectrum + beat + waveform analysis. Status: `in_progress`
    - Add shared PCM decode/mono conversion/resample helper reused across analysis modules.
    - Compute spectrum bands, beat timeline, and waveform proxy from a single decoded track pass.
    - Update scheduling/write path to upsert all available outputs coherently while preserving lazy/on-demand semantics.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`

### T-051 Active-Track In-Memory Analysis Frame Cache
- Spec Ref: Section `5` (analysis/service model), Section `6` (visualizer/plugin contract), Section `8` (non-blocking reliability/performance), `WF-06`
- Status: `in_progress`
- Goal:
  - Eliminate per-poll analysis frame DB lookups by preloading active-track analysis frames into memory and serving render-time reads from in-memory indexed structures.
- Scope:
  - Add store methods to bulk-load cached frames for scalar/spectrum/beat/waveform by track fingerprint + params.
  - Add service-side in-memory frame caches with nearest-frame/interpolated lookup.
  - Trigger async preload on active track changes and clear stale in-memory caches on track switch/stop.
  - Keep existing lazy cache miss scheduling behavior as fallback.
- Non-goals:
  - Removing transport polling.
  - Replacing SQLite persistence for analysis caches.
  - Broad visualizer algorithm rewrites in this task.
- Tasks:
  - `T-051A` Store bulk-read API for analysis frames. Status: `in_progress`
    - Add `list_*` methods for scalar/spectrum/beat/waveform caches.
    - Keep fingerprint/version/params filtering consistent with point-lookups.
  - `T-051B` Service in-memory frame indexes + lookup path. Status: `in_progress`
    - Add memory-first lookup path with bounded cache keying.
    - Preserve fallback behavior and status/source semantics on cache miss.
  - `T-051C` PlayerService preload lifecycle wiring. Status: `in_progress`
    - Schedule preload on track play/change and cancel stale preload jobs.
    - Keep poll loop non-blocking while preloading.
  - `T-051D` Tests for memory-first analysis sampling. Status: `in_progress`
    - Add/adjust tests to validate preload usage and DB fallback behavior.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`

### T-052 Permanent Opt-In Performance Benchmark + Profiling Harness
- Spec Ref: Section `5` (analysis/service model), Section `6` (visualizer/plugin contract), Section `7` (persistence), Section `8` (non-blocking reliability/performance), `WF-02`, `WF-06`, `WF-07`
- ADR Alignment:
  - `ADR-0004` (audio-level service + observability/source semantics)
  - `ADR-0006` (lazy scalar/spectrum cache architecture)
  - `ADR-0007` (search/playlist DB performance + observability)
  - `ADR-0008` (lazy beat cache + perf/observability expansion)
  - `ADR-0009` (defer live waveform; define perf/observability budgets for high-FPS workloads)
- Status: `in_progress`
- Goal:
  - Add a permanent, opt-in performance testing and benchmark workflow that can identify where time is spent (track switching, analysis cache loading, visualizer rendering, controls, and DB operations) and support apples-to-apples comparisons before/after optimizations.
- Why now (current evidence):
  - Runtime logs already surface `visualizer_frame_loop_overrun`, `playlist_store_slow_query`, analysis cache miss scheduling, and analysis preload/sampling stats.
  - Recent in-memory analysis-cache work added memory-vs-DB sampling observability; benchmark coverage should now formalize these metrics into repeatable tests.
- Scope:
  - Extend existing opt-in perf tests (`TZ_PLAYER_RUN_PERF=1`) instead of creating a separate perf framework.
  - Add benchmark scenarios that run against a local media corpus (for example `.local/perf_media/`) and synthetic DB stress data.
  - Capture both wall-clock durations and structured event metrics (cache hit rates, preload frame counts, frame overruns, slow queries).
  - Produce stable comparison artifacts (JSON/CSV summary) for before/after branch benchmarking.
- Non-goals:
  - Turning perf tests into required CI gates for all contributors.
  - Benchmarking network/remote features (out of v1 scope).
  - Replacing runtime logs with a heavyweight tracing dependency.
- Success Criteria / Acceptance:
  - Developers can run a documented opt-in command and obtain a benchmark summary covering:
    - track switch latency (`play/next` to first usable visualizer/level data and cache-ready transitions)
    - analysis preload/cache load timings and frame counts by channel (`spectrum`, `beat`, `waveform_proxy`, `envelope`)
    - visualizer render performance across a representative plugin matrix (median/p95/max frame time, overrun rate)
    - control responsiveness (volume/seek/play/pause/next interactions)
    - playlist DB interactions (window fetch, search, random, item-id listing) including mode-aware search stats
  - Results are persisted in a local artifact format suitable for branch-to-branch comparison.
  - Perf suite remains opt-in and skippable in normal CI/test runs.
- Tasks:
  - `T-052A` Benchmark scenario taxonomy + metric contract. Status: `done`
    - Define canonical scenarios:
      - cold-cache track play
      - warm-cache track play
      - rapid next/prev switching burst
      - long-track analysis-on-demand
      - visualizer matrix render loop
      - controls interaction latency
      - large-playlist DB query matrix (FTS/fallback-aware)
    - Define per-scenario metrics and units (`ms`, `s`, hit rates, frame counts, overrun counts, p50/p95/max).
    - Freeze a machine-readable result schema (JSON) for future comparisons.
  - `T-052B` Instrumentation normalization + event capture hooks. Status: `in_progress`
    - Standardize/expand structured perf events so tests can consume them deterministically (not just human log strings).
    - Ensure event payloads expose timestamps/IDs needed to correlate:
      - track switch start/end
      - analysis preload start/end + frame counts
      - cache miss scheduling + analysis completion
      - visualizer frame overruns / effective runtime FPS
      - DB slow-query events (`playlist_store_slow_query`, search mode)
    - Keep instrumentation lightweight and disabled/low-cost outside perf runs.
  - `T-052C` Local media corpus integration (opt-in). Status: `in_progress`
    - Add perf-test configuration/env support for a local corpus path (default `.local/perf_media/` if present).
    - Validate corpus presence/shape and skip with explicit reason when missing.
    - Record corpus manifest details in benchmark output (track count, durations, formats) for reproducibility.
  - `T-052D` Track-switch and analysis-cache benchmark scenarios. Status: `in_progress`
    - Add opt-in perf tests/scripts that measure:
      - selected/play action -> first fallback frame visible
      - selected/play action -> `fallback -> envelope` transition
      - selected/play action -> spectrum/beat/waveform cache ready (or preload hit)
      - warm-cache replay latencies vs cold-cache latencies
    - Include long-track cases to expose analysis cap/truncation behavior and preload timing.
  - `T-052E` Visualizer performance matrix benchmark. Status: `in_progress`
    - Expand current advanced visualizer perf checks to collect richer metrics (median/p95/max, overrun rate, runtime FPS backoff events).
    - Partition matrix into tiers (`cheap`, `medium`, `heavy`) so regressions are attributable and runtime stays bounded.
    - Include at least one beat-reactive and one waveform-proxy visualizer path per run.
  - `T-052F` Controls and UI interaction benchmark coverage. Status: `in_progress`
    - Add opt-in latency checks for representative control actions (`play/pause`, `next`, `seek`, `volume`, visualizer cycle).
    - Measure while background analysis is active to catch event-loop starvation regressions.
    - Report interaction jitter, not only median latency.
  - `T-052G` DB performance benchmark expansion + correlation. Status: `in_progress`
    - Keep/extend synthetic large-playlist tests in `tests/test_performance_opt_in.py` for fetch/search/list/random.
    - Add scenario coverage for viewport-style repeated nearby window fetches and mixed search patterns.
    - Correlate benchmark failures with slow-query events and operation/mode fields.
  - `T-052H` Result artifact storage + comparison tooling. Status: `in_progress`
    - Emit benchmark summaries to a local git-ignored directory (for example `.local/perf_results/`) with timestamp + git SHA metadata.
    - Add a small comparison utility/script that diff-compares two runs and highlights regressions/improvements by metric and threshold.
    - Keep output human-readable and scriptable (JSON + concise text summary).
  - `T-052I` Documentation + runbook for perf workflow. Status: `todo`
    - Document setup for local perf corpus (`docs/perf-media.md`), recommended machine conditions, and repeatable run steps.
    - Add guidance for:
      - cold vs warm cache runs
      - branch comparison workflow
      - interpreting common bottlenecks (visualizer overruns vs DB slow queries vs analysis cache misses)
    - Link perf workflow from `docs/usage.md` and/or developer docs.
  - `T-052J` Optional profile/deep-dive mode (non-default). Status: `todo`
    - Add a second opt-in mode for deeper profiling (`cProfile`/`pyinstrument`-style local runs or targeted timers) for diagnosing hotspots after a benchmark regression is found.
    - Keep this separate from standard perf benchmarks to preserve run-time stability and comparability.
  - `T-052K` Broad hidden-hotspot sweep coverage (non-obvious paths). Status: `todo`
    - Add opt-in benchmark/probe scenarios for code paths that are easy to overlook but can accumulate meaningful cost under frequent polling/UI updates:
      - state serialization/save-state cadence and file replace paths
      - log formatting/structured logging overhead under high event volume
      - plugin host/frame input assembly and per-frame data marshaling
      - UI status/footer/pane refresh/update churn during playback
      - cache prune scheduling checks / metadata-touch bookkeeping
      - background task orchestration, cancellation, and debounce/coalescing paths
    - Add lightweight counters/timers for “frequency x cost” analysis so low-cost calls with extreme call counts are visible.
    - Include idle-playback and browse-without-playback scenarios to catch costs unrelated to analysis/rendering.
    - Report top repeated operations by cumulative time (best-effort, opt-in only) to expose accidental hot paths.
  - `T-052L` Resource-usage trend capture (CPU/time/memory/GC) for perf runs. Status: `todo`
    - Capture coarse process-level resource signals during opt-in perf runs (CPU %, RSS/high-water mark where available, GC collections/time) alongside latency metrics.
    - Correlate resource spikes with benchmark phases/scenarios to distinguish CPU-bound rendering, DB contention, and memory churn.
    - Keep collection portable and optional so it does not destabilize benchmark comparability across machines.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`
  - `TZ_PLAYER_RUN_PERF=1 .ubuntu-venv/bin/python -m pytest tests/test_performance_opt_in.py`

### T-049 Async/UI Non-Blocking Hardening (Post-#16 Recovery)
- Spec Ref: Section `5` (analysis/service model), Section `6` (visualizer/plugin contract), Section `7` (persistence), Section `8` (non-blocking reliability), `WF-02`, `WF-06`, `WF-07`
- Status: `done`
- Goal:
  - Eliminate remaining UI lag/hang vectors by separating heavy CPU analysis from DB/file I/O pathways and by reducing high-frequency await chains on UI event handlers.
- Audit Findings (current `main`):
  - Shared executor contention: one thread pool handles both DB/file operations and CPU-heavy analysis workloads (`src/tz_player/utils/async_utils.py`).
  - Synchronous visualizer rendering on UI timer path (`src/tz_player/app.py`, `src/tz_player/visualizers/host.py`).
  - Repeated DB index lookups in transport-control refresh on frequent player-state updates (`src/tz_player/ui/playlist_pane.py`, `src/tz_player/app.py`).
  - Synchronous plugin discovery/import/preflight during startup (`src/tz_player/app.py`, `src/tz_player/visualizers/registry.py`).
  - SQLite lock waits can be long under write contention (`src/tz_player/services/playlist_store.py` and analysis stores using `timeout=30` + `BEGIN IMMEDIATE`).
- Scope:
  - Tighten async boundaries so the Textual event loop never performs expensive CPU/import/DB work directly.
  - Add bounded scheduling/backpressure for analysis and DB mutation workloads.
  - Add regression tests proving UI responsiveness under concurrent analysis and lock contention.
- Non-goals:
  - Removing existing playback backends.
  - Replacing SQLite.
  - Adding remote processing/services.
- Tasks:
  - `T-049A` Executor isolation and API split. Status: `done`
    - Introduce `run_cpu_bound(...)` separate from `run_blocking(...)`.
    - Route spectrum/beat/waveform/envelope analysis workloads to CPU-bound executor.
    - Keep DB/file metadata operations on IO executor.
    - Add tests validating correct routing and non-callable argument handling.
  - `T-049B` Analysis scheduling/backpressure controls. Status: `done`
    - Add global per-analysis-type concurrency caps and queue depth protections.
    - Coalesce duplicate analysis requests across poll ticks and rapid track changes.
    - Add cancellation semantics for stale analysis jobs when context changes.
  - `T-049C` Visualizer render path hardening. Status: `done`
    - Ensure frame timer callback remains lightweight and never waits on DB/IO.
    - Add frame-drop/coalescing policy when previous render overruns budget.
    - Add render-time observability metrics and slow-frame warnings for active plugin IDs.
  - `T-049D` UI transport refresh DB-read reduction. Status: `done`
    - Remove per-state-update repeated `get_item_index` calls from hot path.
    - Introduce cached index map or incremental index tracking for cursor/playing rows.
    - Debounce/coalesce transport refresh updates while preserving correctness.
  - `T-049E` Startup/plugin discovery off-loop safeguards. Status: `done`
    - Move plugin discovery/import/preflight scanning off the UI loop.
    - Add timeout/fallback behavior for slow local plugin paths.
    - Preserve current diagnostics and security-policy behavior.
  - `T-049F` SQLite contention mitigation. Status: `done`
    - Add bounded retry/jitter strategy for `database is locked` operational errors.
    - Revisit connection timeout strategy and write batching for mutation-heavy flows.
    - Add stress tests with simulated lock contention while user actions continue.
  - `T-049G` ffmpeg/tool probing cache. Status: `done`
    - Cache ffmpeg-availability checks per session to avoid repeated path lookups in hot UI paths.
    - Keep explicit refresh path for diagnostics if needed.
  - `T-049H` Non-blocking regression suite expansion. Status: `done`
    - Add focused tests for: rapid key input during active analysis, DB lock contention, large folder ingest, and visualizer overrun conditions.
    - Add timing assertions/events to ensure event-loop responsiveness remains within target budget.
  - `T-049I` Playlist scroll/query hot-path stabilization. Status: `done`
    - Remove per-query `PRAGMA journal_mode=WAL` churn from `PlaylistStore` connections; set WAL once during startup init.
    - Add pane-side prefetch cache so cursor/scroll movement reuses over-fetched windows instead of issuing one DB query per row scroll.
    - Add regression coverage ensuring repeated nearby window refreshes do not repeatedly call `fetch_window`.
  - `T-049J` Runtime overload guardrails (analysis + visualizer). Status: `done`
    - Gate lazy envelope analysis to active track after minimum dwell time so rapid skip/browse does not trigger analysis storms.
    - Scale visualizer throttle skip-frames from overrun severity rather than fixed single-frame throttling.
    - Add regression coverage for active-track dwell gating and heavy-overrun throttle scaling.
  - `T-049K` Adaptive runtime FPS control for visualizer frame loop. Status: `done`
    - Add app-level runtime FPS backoff on sustained frame-loop overruns (end-to-end render path).
    - Add gradual FPS recovery after sustained healthy frames.
    - Reset runtime FPS to configured profile when switching visualizers.
  - `T-049L` Shutdown resilience and viewport limit hardening. Status: `done`
    - Guard player-event UI updates during unmount so missing `PlaylistPane` does not crash shutdown.
    - Add Windows-friendly retry around atomic state-file replace to reduce transient `WinError 32` failures.
    - Cap playlist viewport fetch window size to avoid oversized DB reads on very tall terminals.
  - `T-049M` State persistence race elimination on Windows. Status: `done`
    - Serialize app-level state writes via lock to prevent concurrent write/replace collisions.
    - Use unique per-write temp files for `save_state(...)` atomic replace path.
    - Retry transient `WinError 2` replace failures by rewriting temp and retrying.
  - `T-049N` Visualizer adaptive FPS sensitivity tuning. Status: `done`
    - Add overrun-score based FPS backoff trigger so recurring (non-consecutive) overruns still reduce runtime FPS.
    - Add gradual score decay on healthy frames to avoid permanent throttling after transient spikes.
    - Add regression coverage for intermittent-overrun backoff behavior.
  - `T-049O` Global visualizer load-governor alignment. Status: `done`
    - Cap persisted `visualizer_fps` by responsiveness-profile default at startup (unless explicit CLI FPS override is provided).
    - Preserve runtime adaptive FPS budget when cycling visualizers so all plugins share global load governance.
    - Add regression coverage for balanced-profile cap and cross-plugin runtime-FPS preservation.
  - `T-049P` Balanced profile strictness increase. Status: `done`
    - Lower global `balanced` default visualizer FPS from 16 to 14 for improved headroom across all visualizers.
    - Keep `safe` and `aggressive` defaults unchanged.
    - Update runtime/defaulting regression tests to match new baseline.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`

### T-048 Particle Visualizer Expansion Pack (FFT/Beat/RMS Reactive)
- Spec Ref: Section `6` (visualizer/plugin model), Section `8` (reliability/performance), `WF-06`
- Status: `in_progress`
- Goal:
  - Add a new suite of advanced particle-style built-in visualizers that build on the `viz.reactor.particles` style and explicitly embrace raw FFT texture + beat events.
- Scope:
  - Implement one plugin per concept with deterministic, non-blocking render behavior.
  - Keep each plugin capability-gated (`requires_spectrum` / `requires_beat`) and resilient to missing analysis data.
  - Ensure each plugin scales reasonably with dynamic pane height and constrained width layouts.
- Non-goals:
  - Live PCM sample-stream requirement.
  - Per-frame blocking I/O or heavy CPU simulation loops.
- Tasks:
  - `T-048A` `viz.particle.gravity_well` (Gravity Well Reactor). Status: `done`
  - `T-048B` `viz.particle.shockwave_rings` (Audio Shockwave Rings). Status: `done`
  - `T-048C` `viz.particle.rain_reactive` (Particle Rain / reverse-matrix reactive). Status: `done`
  - `T-048D` `viz.particle.orbital_system` (Audio Solar System). Status: `done`
  - `T-048E` `viz.particle.ember_field` (Ember Field). Status: `done`
  - `T-048F` `viz.particle.magnetic_grid` (Magnetic Grid Distortion). Status: `done`
  - `T-048G` `viz.particle.audio_tornado` (Audio Tornado). Status: `done`
  - `T-048H` `viz.particle.constellation` (Constellation Mode). Status: `done`
  - `T-048I` `viz.particle.data_core_frag` (Data Core Fragmentation). Status: `done`
  - `T-048J` `viz.particle.plasma_stream` (Plasma Stream Field). Status: `done`
  - `T-048K` Registry/docs/perf integration for the full particle suite. Status: `done`
- Acceptance:
  - Each plugin is independently selectable via registry and visualizer cycling.
  - Plugins remain deterministic for same frame inputs and degrade safely when data is loading/missing.
  - Full quality gates pass after each delivered plugin change set.

## Archived Recent Work

### T-038 User Drop-In Visualizer Plugins + Security Hardening
- Spec Ref: Section `6` (Plugin discovery/lifecycle), Section `8` (reliability/error handling), `WF-06`, `WF-07`
- Status: `done`
- Goal:
  - Evolve current local-plugin loading into a true user drop-in plugin system with a standard plugin directory and practical security guardrails.
  - Preserve keyboard-first UX, non-blocking render guarantees, and fallback safety.
- Scope:
  - Add deterministic auto-discovery from a default per-user plugin directory.
  - Improve plugin discovery for real-world plugin packages (not only single-file scripts).
  - Add plugin validation/diagnostics and risk controls for untrusted Python plugin code.
  - Document a clear trust model and operational limits.
- Non-goals:
  - Perfect sandboxing of arbitrary Python code inside the main process.
  - Networked/remote plugin download or marketplace behavior.
- Acceptance:
  - User can place a valid plugin in a documented default plugin location and have it discovered without manual state-file editing.
  - Invalid or risky plugins are rejected with explicit log and user-facing diagnostics.
  - Plugin failures continue to degrade safely to `basic` without app crash.
  - Security posture is explicitly documented, including what is and is not guaranteed.
- Tasks:
  - `T-038A` Define plugin directory contract and precedence. Status: `done`
    - Add canonical default plugin directory under app-managed user paths.
    - Define precedence order for plugin discovery sources:
      - built-ins
      - default drop-in directory
      - explicit CLI/plugin path overrides
    - Clarify persistence behavior for configured plugin paths.
  - `T-038B` Implement package-aware discovery model. Status: `done`
    - Support plugin package directories (with `__init__.py`) and multi-file plugins.
    - Keep deterministic discovery ordering and duplicate-ID handling.
    - Ensure startup remains resilient when one plugin/package import fails.
  - `T-038C` Introduce plugin manifest + compatibility validation. Status: `done`
    - Define minimal plugin metadata contract (for example: `plugin_id`, `display_name`, `plugin_api_version`, optional `author`, `version`).
    - Reject plugins with incompatible API version or invalid IDs.
    - Surface reasoned diagnostics for rejected plugins.
  - `T-038D` Add plugin safety policy enforcement (baseline checks). Status: `done`
    - Add static preflight checks for obviously risky constructs in plugin sources (for example direct `subprocess`, `socket`, destructive file ops, dynamic `exec`/`eval` usage), with configurable policy:
      - `warn` mode (default): load with warning
      - `enforce` mode: block load on policy violations
    - Add plugin source allowlist/denylist controls for import paths if needed.
    - Ensure policy outcome is logged and visible to users as runtime notices when relevant.
  - `T-038E` Add process-isolated plugin runner (optional hardened mode). Status: `done`
    - Design/run plugins out-of-process for stronger containment (separate worker process boundary).
    - Define IPC contract for `on_activate`/`render`/`on_deactivate`.
    - Apply resource/time limits and fail-closed fallback behavior when runner is unhealthy.
    - Keep in-process mode available for compatibility/performance.
  - `T-038F` Add plugin management diagnostics UX. Status: `done`
    - Provide a user-visible plugin diagnostics surface (loaded, rejected, reason).
    - Add startup summary with loaded plugin IDs, source path, and policy status.
    - Add a safe rescan workflow (manual action) that does not block UI.
  - `T-038G` Documentation and trust model update. Status: `done`
    - Update `docs/visualizations.md` and `docs/usage.md` with:
      - drop-in folder usage
      - plugin packaging examples
      - security policy modes and defaults
      - explicit trust model and limitations
    - Add a dedicated security note for plugins in `SECURITY.md`.
  - `T-038H` Test coverage and release checks. Status: `done`
    - Unit tests for discovery precedence, package loading, manifest validation, and policy checks.
    - Integration tests for drop-in folder auto-discovery, fallback safety, and diagnostics surfacing.
    - Tests for blocked-risk plugin cases and optional isolated-runner failure handling.
    - Update acceptance mapping docs and release checklist for plugin-security posture.
- Risks / Decisions Needed:
  - Python in-process plugins cannot be fully sandboxed; meaningful containment requires process isolation plus OS-level restrictions where available.
  - Strict security policy may reject legitimate plugins; policy defaults and override UX must be clear.
  - Cross-platform isolation capabilities differ (Linux/macOS/Windows), requiring capability-gated behavior.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`

### T-039 Lazy Persistent Analysis Cache (Scalar + FFT) with Retention and Migration
- Spec Ref: Section `5` (audio level service), Section `6` (plugin model), Section `7` (data/state), Section `8` (reliability), `WF-06`
- Status: `done`
- Goal:
  - Implement lazy, on-demand analysis caching for both scalar level data and FFT/spectrum data.
  - Persist results in DB once computed so they survive playlist clear operations.
  - Enforce retention policy to keep storage bounded.
  - Serve both scalar and FFT analysis to visualizer plugins through non-blocking services.
- Scope:
  - Add FFT/spectrum cache schema + service.
  - Refactor scalar cache lifecycle so it is not implicitly tied to playlist contents.
  - Add migration path from current schema to new cache model.
  - Add service contracts for plugin consumption of scalar + FFT on request.
  - Keep all analysis work async/background and non-blocking to Textual/UI loop.
- Non-goals:
  - Real-time live FFT capture from playback backends in this phase.
  - Sidecar file export/import in this phase.
- Acceptance:
  - No scalar/FFT analysis is computed unless requested by active visualization flows.
  - Once computed, scalar/FFT analysis is persisted and reused across restarts and playlist clears.
  - Cache retention policy is enforced deterministically and verified by tests.
  - Plugins can request scalar + FFT data via stable service contracts with source metadata.
  - DB migration is backward-compatible and validated by migration tests.
- Tasks:
  - `T-039A` Define analysis data contracts for scalar + FFT services. Status: `done`
    - Finalize request/response models for scalar and spectrum samples.
    - Include source metadata tokens (`live|cached|fallback` style).
    - Define lazy-load state tokens (`ready|loading|missing|error`).
  - `T-039B` Design persistent schema for FFT cache and scalar cache ownership. Status: `done`
    - Add FFT analysis tables (analysis metadata + frame/band payload storage).
    - Ensure scalar cache tables are modeled as media-analysis cache, not playlist-owned data.
    - Add indexes for efficient position-based lookup.
  - `T-039C` Implement DB migration path and compatibility handling. Status: `done`
    - Add schema migration steps from current DB version to new analysis-cache schema.
    - Ensure startup upgrades are deterministic and crash-safe.
    - Add downgrade/read-compat expectations in docs/tests where applicable.
  - `T-039D` Implement `SpectrumService` (lazy, async, background-only). Status: `done`
    - Add on-demand analysis scheduling only when spectrum data is requested.
    - Run decode/FFT work off the event loop using background workers.
    - Persist computed results and serve cached frames by playback position.
  - `T-039E` Refactor scalar analysis service to same lazy persistent model. Status: `done`
    - Ensure scalar analysis is request-triggered and persisted once computed.
    - Preserve existing fallback behavior and source-priority semantics.
    - Ensure playlist clear does not erase analysis cache.
  - `T-039F` Implement retention policy and cache pruning. Status: `done`
    - Add deterministic pruning policy with bounded storage behavior.
    - Run pruning off-loop and avoid UI starvation.
    - Emit observability events for prune runs and reclaimed entries/bytes.
  - `T-039G` Plugin-facing API wiring for scalar + FFT requests. Status: `done`
    - Add plugin input/service access pattern for optional FFT and scalar reads.
    - Guarantee non-blocking render path (cache-only reads in render; schedule work elsewhere).
    - Keep fallback rendering deterministic when analysis is unavailable/loading.
  - `T-039G.1` Visualizer contract/versioning transition plan. Status: `done`
    - Decide whether to extend current plugin contract or introduce a new versioned contract surface.
    - Define compatibility guarantees for existing plugins and required fields for new plugins.
    - Add explicit plugin API version bump rules and deprecation timeline notes.
  - `T-039G.2` Backward-compat adapter for existing visualizers. Status: `done`
    - Ensure all current built-in visualizers continue to run unchanged under the new data-service model.
    - Provide adapter/shim behavior so old plugins that do not request FFT/scalar service data still render correctly.
    - Add fallback handling for plugins missing new optional capabilities.
  - `T-039G.3` Built-in visualizer update pass for new service access. Status: `done`
    - Update built-in visualizers that benefit from scalar/FFT data to use the new request path safely.
    - Keep deterministic output and frame-budget constraints intact.
    - Ensure each updated built-in visualizer handles `loading|missing|error` service states explicitly.
  - `T-039G.4` Contributor-facing plugin authoring guidance update. Status: `done`
    - Document old vs new contract usage clearly for plugin authors.
    - Provide minimal examples for:
      - legacy-compatible visualizer
      - scalar-aware visualizer
      - FFT-aware visualizer
    - Document required behavior for non-blocking render and lazy service requests.
  - `T-039H` Docs, ADR, and acceptance mapping updates. Status: `done`
    - Update `docs/visualizations.md`, `docs/usage.md`, and workflow docs for lazy cache semantics.
    - Create/update ADR for analysis-cache schema + retention model.
    - Update `docs/workflow-acceptance.md` with new test mapping.
  - `T-039I` Validation and resilience test suite. Status: `done`
    - Unit tests for contracts, scheduling, cache hits/misses, and pruning behavior.
    - Migration tests for old DB -> new schema.
    - Integration tests for plugin request flows and playlist-clear persistence behavior.
    - Non-blocking regression tests for UI responsiveness during analysis/prune work.
    - Compatibility tests proving existing built-in visualizers behave unchanged under new contract plumbing.
    - Contract tests for legacy plugin compatibility and new-version plugin capability signaling.
- Decisions Needed (Blocked Until Chosen):
  - `T-039D.1` FFT representation and density defaults. Status: `done`
    - Chosen defaults:
      - `band_count = 48`
      - `hop_ms = 40` (about 25 FPS equivalent)
      - Store spectrum bands as quantized `uint8` values.
  - `T-039F.1` Retention policy limits. Status: `done`
    - Chosen policy: hybrid retention with:
      - `max_cache_bytes = 2 GB`
      - `max_age_days = 180`
      - `min_recent_tracks_protected = 200` (unless hard cap must be enforced)
  - `T-039F.2` Prune trigger policy. Status: `done`
    - Chosen trigger strategy: hybrid
      - Run prune once on startup with delayed scheduling.
      - Run prune after analysis writes only when cache usage exceeds `90%` of cap.
      - Manual prune command is optional future enhancement.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`

### T-041 Observability Hardening + Large Playlist Scalability
- Spec Ref: Section `8` (diagnostics/logging), `WF-02`, `WF-03`, `WF-05`, `WF-07`
- Status: `done`
- Goal:
  - Improve runtime observability for heavy playlist operations and analysis workflows.
  - Reduce query/path bottlenecks for very large playlists (target: up to 100k items).
- Scope:
  - Add structured slow-path telemetry for playlist DB hotspots and cache pipeline events.
  - Replace high-cost random item selection query patterns that do full-table sort work.
  - Add/expand opt-in performance checks focused on high-count playlist navigation/search actions.
  - Document large-playlist limits and recommended runtime flags/workflows.
- Non-goals:
  - Sidecar analysis cache export/import features.
  - Remote/clustered metadata or search systems.
- Tasks:
  - `T-041A` PlaylistStore observability instrumentation. Status: `done`
    - Add structured slow-query logging around high-traffic DB operations.
    - Include operation name, elapsed time, and key context fields.
  - `T-041B` Remove `ORDER BY RANDOM()` scale bottleneck. Status: `done`
    - Replace full-table random sort selection with count + random offset selection.
    - Preserve exclusion semantics and deterministic testability.
  - `T-041C` High-count playlist opt-in perf checks. Status: `done`
    - Add perf checks that exercise 100k-ish playlist scenarios in opt-in mode.
    - Validate key interactions remain within practical budget envelopes.
  - `T-041D` Large-playlist usage/docs guidance. Status: `done`
    - Document expected behavior and caveats for very large playlists.
    - Add troubleshooting notes for heavy metadata/search workloads.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`

### T-042 Large-Library Metadata/Search Scalability + Indexing
- Spec Ref: Section `7` (persistence/state), Section `8` (reliability/diagnostics), `WF-02`, `WF-04`, `WF-07`
- Status: `done`
- Goal:
  - Keep Find/search and metadata-driven list operations responsive for very large playlists/libraries (100k+ rows).
- Scope:
  - Introduce an indexed full-text search path for playlist search with graceful compatibility fallback.
  - Add migration-safe schema changes and sync wiring so search index stays accurate as tracks/metadata change.
  - Expand observability around search-path selection and slow metadata/search operations.
  - Add opt-in scale tests and usage guidance for large-library search behavior.
- Non-goals:
  - Remote/cloud search systems.
  - Relevance-ranking engines beyond deterministic local matching.
- Tasks:
  - `T-042A` Add SQLite FTS-backed playlist search index + migration path. Status: `done`
    - Add a schema migration that creates playlist search FTS structures when supported.
    - Keep migration behavior safe on SQLite builds without FTS5 support.
  - `T-042B` Wire PlaylistStore search to FTS with deterministic fallback. Status: `done`
    - Use FTS query path by default where available.
    - Fall back to existing LIKE-based path when FTS is unavailable.
    - Emit search mode in slow-query observability fields.
  - `T-042C` Keep search index synchronized with playlist/metadata mutations. Status: `done`
    - Ensure add/remove/reorder and metadata/path updates keep search source data accurate.
    - Add regression tests for synchronization correctness.
  - `T-042D` Expand high-count search perf checks and docs guidance. Status: `done`
    - Add/extend opt-in perf tests focusing on worst-case search behavior at large scale.
    - Document behavior/limitations/tuning notes for search on large libraries.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`

### T-043 Lazy Beat Detection Cache + Visualizer Contract Wiring
- Spec Ref: Section `5` (analysis services), Section `6` (visualizer/plugin model), Section `7` (persistence/schema), Section `8` (reliability)
- Status: `done`
- Goal:
  - Add lazy, cache-backed beat detection (onset strength + beat marker + tempo estimate) with the same persistence and cleanup behavior used by scalar and spectrum analysis.
- Scope:
  - Add beat-analysis compute service and SQLite cache model.
  - Schedule beat analysis only when beat-capable visualizers request it.
  - Persist beat data in shared analysis cache and prune under existing retention policy.
  - Expose beat fields in visualizer frame contract and plugin capability signaling.
- Non-goals:
  - Studio-grade beat tracking accuracy.
  - Live backend PCM beat extraction in this phase.
- Tasks:
  - `T-043A` Schema migration for beat cache frames. Status: `done`
    - Add DB migration for beat frame table under shared analysis cache model.
    - Preserve backward-compatible startup migration behavior.
  - `T-043B` Beat analysis + store/service implementation. Status: `done`
    - Add lazy beat analysis helper.
    - Add SQLite beat store and cache-first beat service.
  - `T-043C` App/PlayerService scheduling and state wiring. Status: `done`
    - Add beat scheduling tasks and background compute path.
    - Add beat fields to player state and visualizer frame payload.
  - `T-043D` Visualizer capability contract update. Status: `done`
    - Add optional `requires_beat` capability signaling.
    - Keep legacy plugin compatibility unchanged.
  - `T-043E` Tests/docs/ADR updates. Status: `done`
    - Add unit/integration tests for beat analysis, store/service, and capability wiring.
    - Update user/docs acceptance mapping and ADR record.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`

### T-044 Advanced Visualizer Plugin Pack (Practical + Capability-Gated)
- Spec Ref: Section `6` (visualizer/plugin model), Section `8` (reliability/error handling), `WF-06`, `WF-07`
- Status: `done`
- Goal:
  - Add a curated set of advanced built-in visualizer plugins inspired by the proposed concepts, while preserving non-blocking render constraints and graceful capability fallback behavior.
- Scope:
  - Implement practical visualizers now using existing lazy analysis services (scalar, FFT, beat).
  - Explicitly gate or defer concepts that require unavailable runtime data (true live waveform/stereo sample stream or phase).
  - Keep plugin IDs deterministic and contract-compatible for third-party plugin authors.
- Non-goals:
  - Live PCM waveform/phase extraction from playback backends in this task.
  - GPU-accelerated or non-terminal rendering paths.
- Tasks:
  - `T-044A` Spectrogram Waterfall (history heatmap). Status: `done`
    - New plugin ID: `viz.spectrogram.waterfall`.
    - Use FFT bands with rolling history buffer and intensity glyph ramps.
    - Add optional beat pulse accent on newest row.
  - `T-044B` Audio Terrain (spectral landscape). Status: `done`
    - New plugin ID: `viz.spectrum.terrain`.
    - Group FFT bins into width buckets with filled curve rendering.
    - Add optional beat-triggered terrain lift/flash effect.
  - `T-044C` Radial Spectrum (donut analyzer). Status: `done`
    - New plugin ID: `viz.spectrum.radial`.
    - Render spoke-based radial FFT approximation in terminal grid.
    - Add short peak-hold and beat ring pulse.
  - `T-044D` Particle Reactor / Starfield Burst. Status: `done`
    - New plugin ID: `viz.reactor.particles`.
    - Drive particle spawn/velocity from bass-mid-high aggregate + RMS + beat.
    - Keep deterministic bounded particle counts for frame-budget safety.
  - `T-044E` Typography Visual (metadata + glitch/glow). Status: `done`
    - New plugin ID: `viz.typography.glitch`.
    - Render title/artist-centered layout with subtle RMS/FFT modulation.
    - Apply beat-triggered brief glitch/border pulse effects with readability guardrails.
  - `T-044F` Oscilloscope/Persistence and Lissajous feasibility gate. Status: `done`
    - Document current constraints for true oscilloscope and stereo XY:
      - no guaranteed live time-domain sample stream in current backend abstraction
      - no reliable stereo phase/L-R sample feed for visualizer frame contract
    - Define practical fallback designs that can run on FFT+scalar only (stylized approximation mode).
    - Mark true waveform/phase variants as blocked until a live-sample capability task is approved.
  - `T-044G` Visualizer contract/docs updates for new effects. Status: `done`
    - Ensure `docs/visualizations.md` lists new plugin IDs, capability requirements, and fallback semantics.
    - Add concise plugin-author guidance for effect patterns using scalar/FFT/beat without blocking render.
    - Confirm compatibility statement for existing plugins remains unchanged.
  - `T-044H` Performance and reliability validation for advanced visualizers. Status: `done`
    - Add tests for render determinism, fallback behavior, and no-crash degradation.
    - Add opt-in perf checks for high-refresh scenarios and large-pane sizes.
    - Ensure no per-frame blocking I/O and no keyboard responsiveness regressions.
- Recommended implementation order:
  1. `T-044A` Spectrogram Waterfall
     - Lowest complexity, highest immediate value using existing FFT pipeline.
  2. `T-044E` Typography Visual
     - Fast to ship and leverages metadata + scalar/beat with low render risk.
  3. `T-044B` Audio Terrain
     - Reuses FFT grouping patterns; moderate complexity, strong visual payoff.
  4. `T-044D` Particle Reactor
     - Introduces simulation state; do after simpler deterministic renderers.
  5. `T-044C` Radial Spectrum
     - Hardest terminal geometry/render mapping; defer until core pack is stable.
  6. `T-044G` Contract/docs updates
     - Finalize docs once concrete plugin behavior/IDs are settled.
  7. `T-044H` Performance/reliability validation
     - Run after feature completion as release gate for the pack.
  8. `T-044F` Oscilloscope/Lissajous feasibility gate
     - Keep as explicit capability decision milestone; do when evaluating next data-contract expansion.
- Acceptance:
  - At least five concepts are implemented with existing services (`FFT`/`scalar`/`beat`) and selectable via registry.
  - Oscilloscope/Lissajous true-signal variants are clearly capability-gated (or deferred) with explicit docs.
  - New visualizers meet render-budget and fallback reliability expectations.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`

### T-045 Live Sample Stream Capability for True Waveform/Phase Visualizers
- Spec Ref: Section `5` (analysis/service model), Section `6` (visualizer/plugin contract), Section `8` (non-blocking reliability)
- Status: `deferred`
- Goal:
  - Introduce an explicit live sample stream capability so true oscilloscope and stereo Lissajous visualizers can be implemented with signal-accurate inputs.
- Blockers:
  - Backend abstraction does not currently expose bounded live sample windows.
  - `VisualizerFrameInput` does not currently carry waveform/stereo phase sample vectors.
  - Perf/observability budgets for high-rate sample consumers are not yet defined.
- Deferral note:
  - Deferred by decision in favor of the cached waveform-proxy approach implemented in `T-047` for v1 scope.
- Required decision inputs:
  - Which backends must support live samples for v1/v1.1 target.
  - Sample window format/rate/channel model for plugin-facing contract.
  - Scheduling/backpressure policy to prevent UI starvation.

### T-046 Visualizer Responsiveness Tuning Profiles (Safe/Balanced/Aggressive)
- Spec Ref: Section `6` (visualizer rendering), Section `8` (performance/reliability), `WF-06`, `WF-07`
- Status: `done`
- Goal:
  - Improve perceived visualizer responsiveness while preserving keyboard-first responsiveness and non-blocking guarantees.
- Scope:
  - Tune render cadence, analysis cadence, and plugin-level smoothing/hold behavior.
  - Add profile-based defaults (`safe`, `balanced`, `aggressive`) with deterministic runtime behavior.
  - Add observability/perf checks to prevent regressions or hidden throttling.
- Non-goals:
  - Live PCM sample stream contract changes (tracked separately in `T-045`).
  - Rewriting visualizer architecture.
- Tasks:
  - `T-046A` Add responsiveness profiles and runtime config wiring. Status: `done`
    - Define profile presets:
      - `safe`: low CPU / conservative cadence
      - `balanced`: recommended default
      - `aggressive`: high responsiveness / higher CPU
    - Wire profile selection via runtime config and CLI with clear precedence docs.
  - `T-046B` Render cadence tuning (host FPS targets). Status: `done`
    - Set profile-specific visualizer FPS targets.
    - Keep existing hard clamps and fallback safety.
    - Ensure host throttle behavior remains deterministic.
  - `T-046C` Analysis cadence tuning (scalar/FFT/beat freshness). Status: `done`
    - Tune FFT hop/lookup cadence by profile where practical.
    - Tune scalar update cadence and beat pulse/hold windows.
    - Preserve cache model and non-blocking scheduling.
  - `T-046D` Plugin inertia pass for built-in reactive visualizers. Status: `done`
    - Reduce smoothing/hold constants where latency feel is excessive.
    - Keep readability and stability for paused/low-signal states.
    - Validate deterministic output remains intact for same inputs.
  - `T-046E` Observability for responsiveness/throttle detection. Status: `done`
    - Add/expand structured logs for:
      - render overruns
      - skipped/throttled frames
      - active responsiveness profile
    - Provide actionable diagnostics in perf runs.
  - `T-046F` Performance and UX validation matrix. Status: `done`
    - Add profile-aware checks for:
      - median render time and worst-frame budget
      - no keyboard responsiveness regressions
      - no excessive host throttling under target pane sizes
    - Keep opt-in heavy perf coverage for larger panes/high frame counts.
- Acceptance:
  - `balanced` profile yields visibly faster response than current baseline without breaking UI responsiveness.
  - `safe` profile remains stable on lower-resource systems.
  - `aggressive` profile remains bounded by host throttle protections and clearly documented tradeoffs.
  - Profile behavior is documented and test-covered.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`

### T-047 Waveform-Proxy Cache for PCM-Like Visualizer Signals
- Spec Ref: Section `5` (analysis services), Section `6` (visualizer/plugin contract), Section `7` (persistence), Section `8` (non-blocking reliability), `WF-06`
- Status: `done`
- Goal:
  - Add a lightweight waveform-proxy analysis/cache that provides PCM-like shape data for visualizers without storing raw PCM.
  - Keep storage and CPU bounded while preserving lazy/on-demand analysis behavior.
- Scope:
  - Introduce a new proxy feature set per time-slice (for example `min_l`, `max_l`, `min_r`, `max_r`) using quantized storage.
  - Reuse existing decode + lazy cache pipeline patterns (wave/ffmpeg decode, async scheduling, persisted DB cache, retention).
  - Expose proxy readings to visualizers/plugins through the same non-blocking service model used for scalar/FFT/beat.
- Non-goals:
  - True live PCM sample stream contract (remains tracked by `T-045`).
  - Storing full PCM payloads in DB.
- Design decisions required before implementation:
  - `T-047D.1` Proxy frame schema density defaults. Status: `done`
    - Chosen defaults:
      - cadence: profile-tuned hop (`safe=30ms`, `balanced=20ms`, `aggressive=10ms`)
      - quantization: signed `int8` min/max channel extrema (`min_l/max_l/min_r/max_r`)
  - `T-047D.2` Interpolation/render policy. Status: `done`
    - Chosen policy:
      - store nearest frame buckets and resolve playback lookup via nearest-neighbor frame selection
      - plugin guidance documents proxy as PCM-like envelope ranges, not sample-accurate vectors
- Tasks:
  - `T-047A` Define waveform-proxy data contract. Status: `done`
    - Add request/response model for proxy reads (source/status tokens aligned with existing analysis services).
    - Define normalized value ranges and timestamp semantics.
  - `T-047B` Add persistent schema + migration for proxy cache. Status: `done`
    - Add cache entry type and per-frame proxy table keyed by track fingerprint + params hash.
    - Add indexes for efficient position-based lookup.
    - Add migration tests for schema upgrades.
  - `T-047C` Implement proxy analysis generator. Status: `done`
    - Reuse existing decode inputs and derive per-window extrema/features.
    - Keep work off UI loop and bounded by `max_frames`/time-window controls.
  - `T-047D` Implement `WaveformProxyService` (lazy, async, cache-first). Status: `done`
    - Cache hit: return ready proxy frame for playback position.
    - Cache miss: schedule background analysis and return fallback/loading token.
    - Preserve deterministic behavior on missing/error paths.
  - `T-047E` Wire player/runtime state and visualizer contract. Status: `done`
    - Add optional proxy fields to player/visualizer frame input.
    - Keep backward compatibility for existing plugins.
    - Add at least one built-in visualizer path that consumes proxy data (or adapter in existing pseudo-wave plugin).
  - `T-047F` Retention + observability integration. Status: `done`
    - Ensure proxy cache participates in global analysis retention/pruning.
    - Add structured logs for proxy cache hit/miss/schedule/prune activity.
  - `T-047G` Performance/reliability validation at scale. Status: `done`
    - Add tests for large playlist scenarios and bounded storage growth.
    - Add opt-in perf checks to verify no keyboard responsiveness regressions.
    - Validate no per-frame blocking I/O in visualizer render paths.
  - `T-047H` Docs and acceptance mapping updates. Status: `done`
    - Update `docs/visualizations.md` and `docs/usage.md` with proxy capability and limitations.
    - Update `docs/workflow-acceptance.md` mapping for new proxy service/tests.
- Acceptance:
  - Proxy analysis remains lazy/on-demand and persisted once computed.
  - Storage footprint stays substantially smaller than raw PCM while supporting waveform-like visuals.
  - Existing visualizers/plugins continue to function without requiring proxy fields.
  - At least one visualizer demonstrates proxy-backed PCM-like rendering behavior.
- Validation (per implementation change set):
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`
### DOC-001 Internal Documentation Campaign (All Project Files)
- Status: `done`
- Goal:
  - Add maintainable internal documentation so a contributor can open any project file and quickly understand purpose, relationships, dependencies, and non-obvious logic.
  - Execute this work on a dedicated branch and merge by PR after full validation.
- Branch / PR workflow:
  - Working branch: `docs/internal-documentation-campaign`
  - Commit format:
    - `docs(<area>): add internal documentation for <module-or-path>`
  - PR title format:
    - `docs: internal documentation pass across project files`
- Scope:
  - Python source files in `src/`
  - Tests in `tests/`
  - Python-supporting project files (`pyproject.toml`, `noxfile.py`, tooling scripts)
  - Key contributor docs where relationship/dependency notes are needed
- Documentation standards:
  - Add/update module docstrings describing file role and major collaborators.
  - Add/update class/function/method docstrings where behavior or contracts are not obvious.
  - Add concise inline comments only where logic is non-trivial or decision-heavy.
  - Prefer dependency and relationship notes near integration boundaries (UI/app/service/storage/playback/plugin).
  - Keep comments/docstrings synchronized with actual behavior; avoid stale narrative text.
- Tasks:
  - `DOC-001A` Build coverage inventory file (for example `docs/internal-doc-coverage.md`) listing every in-scope file with status (`todo`/`in_progress`/`done`). Status: `done` (`docs/internal-doc-coverage.md`)
  - `DOC-001B` Document application entrypoint and app shell wiring (focus, actions, event routing, startup/shutdown flow). Status: `done` (`src/tz_player/app.py`, `src/tz_player/gui.py`, `src/tz_player/cli.py`, `src/tz_player/__init__.py`, `src/tz_player/doctor.py`)
  - `DOC-001C` Document playback, queue, and transport layers with lifecycle and error-handling notes. Status: `done` (`player_service`, `playback_backend`, `fake_backend`, `vlc_backend`, `playlist_store`, `playlist_pane`, `playlist_viewport`, `transport_controls`)
  - `DOC-001D` Document persistence/state/config services including schema assumptions and migration-sensitive behavior. Status: `done` (`state_store`, `db/schema`, `db/__init__`, `paths`, `runtime_config`, `logging_utils`)
  - `DOC-001E` Document visualizer/plugin architecture, registry/fallback decisions, and service dependencies. Status: `done` (`visualizers/__init__`, `base`, `registry`, `host`, `basic`, `matrix`, `hackscope`, `vu`, `cover_ascii`)
  - `DOC-001F` Document shared utilities/helpers and cross-cutting abstractions. Status: `done` (`events`, `media_formats`, `version`, `utils/*`, `services/__init__`, `ui/__init__`)
  - `DOC-001G` Document tests with intent-focused docstrings for fixtures/helpers and non-obvious scenarios. Status: `done` (all files under `tests/` reviewed/documented and marked complete in `docs/internal-doc-coverage.md`)
  - `DOC-001H` Document tooling/config files with rationale for important settings and developer workflow dependencies. Status: `done` (`pyproject.toml`, `noxfile.py`, all `tools/*` scripts, `README.md`, `CONTRIBUTING.md`)
  - `DOC-001I` Run required quality gates and fix docstring/comment style issues discovered by lint/type/test checks. Status: `done` (`ruff`, `ruff format --check`, `mypy src`, and `pytest` passing on documentation branch)
  - `DOC-001J` Open PR with a completion checklist confirming 100% inventory coverage and reviewer notes. Status: `done` (PR merged; checklist was provided from `docs/internal-doc-pr-checklist.md`)
- Minimum validation per docs change set:
  - `.ubuntu-venv/bin/python -m ruff check .`
  - `.ubuntu-venv/bin/python -m ruff format --check .`
  - `.ubuntu-venv/bin/python -m mypy src`
  - `.ubuntu-venv/bin/python -m pytest`
- Acceptance:
  - Every file in the coverage inventory is marked `done`.
  - Each in-scope source file has sufficient internal documentation for maintenance-level understanding.
  - No behavior regressions introduced by documentation edits.
  - Documentation branch merged via PR.

## Archived Completed Work

### CR-000 File-by-File Maintainer Review Campaign — Completed
- Goal:
  - Review every Python file and Python-supporting config/setup file one at a time using the standardized reviewer prompt.
  - Keep scope to a single file per review pass unless cross-file test updates are required.
- Review prompt:
  - Use the maintainer review prompt provided in the working thread for each file, replacing `<PATH/TO/FILE.py>` with the active target path.
- Execution policy:
  - One file per review cycle.
  - If code changes are made, run required quality gates before committing:
    - `.ubuntu-venv/bin/python -m ruff check .`
    - `.ubuntu-venv/bin/python -m ruff format --check .`
    - `.ubuntu-venv/bin/python -m mypy src`
    - `.ubuntu-venv/bin/python -m pytest`
  - Commit after tests pass for that file review so rollback remains granular.
  - Commit message format:
    - `review(<path>): apply maintainer review findings`
  - Mark the reviewed file entry as complete only after commit.
- Status: `done`

### T-034 to T-037 QoL Task Set — Completed
- Scope:
  - T-034 `Add files...` text modal replaced by keyboard-first tree picker with drive/root navigation and multi-file selection.
  - T-035 `Add folder...` moved to tree picker folder-only mode with deterministic recursive scan/add.
  - T-036 Added `pageup/pagedown` playlist navigation with clamped page movement.
  - T-037 Completed focus visibility pass for interactive controls.
- Acceptance:
  - Add files/folder workflows now use tree selection UX.
  - Page navigation works from keyboard-first playlist flows.
  - Focus visibility is clear across main interactive controls.
- Tests:
  - UI and integration coverage updated for picker flows, folder selection constraints, page navigation, and focus-style hooks.
- Status: `done`

### CR-001 Review Queue (Python + Supported Config/Setup Files) — Completed
- Scope: Track completion of the file-by-file maintainer review queue defined by CR-000.
- Outcome:
  - All listed Python and Python-supporting config/setup files were reviewed and checked off.
  - Active queue removed after full completion to keep backlog focused.
- Status: `done`

### T-033 CLI Help Metadata Footer
- Spec Ref: Section `10` (CLI and process-level behavior), Section `11` (user docs parity)
- Scope:
  - Add project metadata to CLI help output:
    - GitHub repository URL
    - Current runtime platform
    - Current version
- Acceptance:
  - `--help` output includes URL, platform, and version in a visible footer section.
  - Parser behavior remains compatible across app/gui/cli entrypoints.
- Tests:
  - Parser help tests assert metadata footer content for app/gui/cli parser builders.
- Status: `done`

### T-026 to T-032 Stabilization Tasks — Completed

#### T-026 DB Startup Failure Classification and User Guidance
- Spec Ref: Section `8` (Common failure classes), `WF-01`
- Scope:
  - Detect and classify SQLite init/access failures during startup (for example: file permission denied, path not writable, locked/corrupt DB).
  - Surface tailored user-facing remediation copy instead of generic startup failure text.
- Acceptance:
  - DB init/access failures show actionable message with what failed, likely cause, and immediate next step.
  - Recovery path remains non-blocking where possible; irrecoverable startup exits cleanly.
- Tests:
  - Startup resilience tests for representative DB failures with expected user-facing copy.
  - Regression test ensuring non-DB startup failures keep existing fallback behavior.
- Status: `done`
- Commit: `cf77a9e`

#### T-027 Fatal Startup Exit-Code Contract Hardening
- Spec Ref: Section `8` (Fatal startup failure non-zero exit), Section `10`
- Scope:
  - Ensure irrecoverable startup failures produce non-zero process exit codes from CLI entrypoints.
  - Ensure CLI output includes concise remediation hints for fatal startup exits.
- Acceptance:
  - Fatal startup path exits with non-zero code.
  - Fatal startup path emits user-actionable terminal output (not only log-only diagnostics).
- Tests:
  - CLI tests for fatal startup paths asserting exit code and stderr/stdout hints.
  - Regression test for successful startup retaining exit code zero behavior.
- Status: `done`
- Commit: `cf77a9e`

#### T-028 Unified Non-Fatal Error Surfacing (Banner/Status Channel)
- Spec Ref: Section `8` (UI errors surfaced with modal/error banner), Section `4`
- Scope:
  - Add a consistent non-fatal UI error surface for operational failures that do not require modal interruption.
  - Route key runtime failures (playback action errors, visualizer fallbacks, cache/service warnings) through this surface.
- Acceptance:
  - Users can see clean, actionable runtime errors without relying on logs.
  - Error surface does not trap focus or block keyboard-first workflows.
- Tests:
  - UI tests asserting banner/status error visibility and dismissal behavior.
  - Regression tests ensuring existing modal flows continue to work for blocking failures.
- Status: `done`
- Commit: `e5fa8a2`

#### T-029 Visualizer Observability Completion (Load/Activate/Fallback)
- Spec Ref: Section `9` (Visualizer observability)
- Scope:
  - Ensure explicit structured logs for registry load summary, plugin activation success/failure, and fallback transitions.
  - Align log fields for these events with structured-file logging conventions.
- Acceptance:
  - Logs clearly show plugin registry composition and active visualizer transitions.
  - Fallback transitions are traceable with failed `plugin_id` and phase (`activate`/`render`).
- Tests:
  - Unit tests for expected log events and fields across load/activate/fallback paths.
  - Regression test ensuring no per-frame logging spam is introduced.
- Status: `done`
- Commit: `e5fa8a2`

#### T-030 Configurable Local Plugin Path UX/CLI Wiring
- Spec Ref: Section `6` (Plugin discovery sources), Section `WF-07`
- Scope:
  - Add first-class runtime configuration for local visualizer plugin paths (CLI and persisted state).
  - Document configuration precedence and usage examples.
- Acceptance:
  - Users can configure one or more local plugin import paths without manual state-file editing.
  - Config precedence remains deterministic (CLI > persisted > default).
  - Startup remains resilient when configured path entries are invalid.
- Tests:
  - Parser/runtime config tests for plugin path flags and precedence.
  - Integration tests for successful path loading and invalid path degradation.
- Status: `done`
- Commit: `e5fa8a2`

#### T-031 Final Reliability/Observability Acceptance and Docs Parity
- Spec Ref: Sections `8`, `9`, `10`, `11`
- Scope:
  - Update acceptance mapping and user docs to cover T-026..T-030 behavior.
  - Confirm workflow-to-test mapping includes new reliability and observability guarantees.
- Acceptance:
  - `docs/workflow-acceptance.md` includes the new coverage links.
  - `README.md`/`docs/usage.md` include updated troubleshooting guidance for startup and runtime errors.
- Tests:
  - N/A (docs/mapping), validated by review checklist plus full test/lint/type gates.
- Status: `done`
- Commit: `e5fa8a2`

#### T-032 Embedded Cover Art ASCII Visualizer Pack (Static + Motion)
- Spec Ref: `WF-06`, Sections `4`, `6`, `8`, `11`
- Scope:
  - Add a new visualizer pack that renders embedded track artwork as terminal-safe color ASCII.
  - Deliver two plugin IDs:
    - `cover.ascii.static` for deterministic static art rendering.
    - `cover.ascii.motion` for deterministic animation effects (phase 1: wipe/slide; optional rotation only if frame budget is maintained).
  - Keep plugin behavior non-blocking by moving metadata/art extraction and image decode work off the Textual event loop.
  - Use embedded art when available; degrade gracefully to explicit fallback text when art is missing/invalid.
- Implementation Plan:
  - Phase 0: Contract and dependency decision
    - Decide image decode backend for embedded bytes (recommended: `Pillow`; fallback: plugin remains disabled without decoder).
    - Confirm TinyTag usage path for artwork (`TinyTag.get(..., image=True)` + `images.any`) and compatibility with existing metadata reads.
    - Define plugin-local cache contract keyed by track fingerprint (`track_path`, file mtime/size, pane size, ANSI mode).
  - Phase 1: Shared artwork pipeline (non-blocking)
    - Add an artwork extraction/transform helper used by both plugins.
    - Run extraction/decode/resize/quantization via a background thread executor and cache results.
    - Add bounded memory behavior (LRU or capped map) and explicit placeholder states: `Loading`, `No embedded artwork`, `Artwork decode failed`.
  - Phase 2: `cover.ascii.static` plugin
    - Render color ASCII frame from cached transformed art only (no blocking work in `render`).
    - Support ANSI on/off modes deterministically.
    - Preserve deterministic output for same `VisualizerFrameInput` and cached source.
  - Phase 3: `cover.ascii.motion` plugin
    - Reuse static plugin source frame(s) and apply frame-index-driven deterministic transforms.
    - Implement low-cost effects first (wipe/slide) and gate optional rotation behind render budget checks.
    - Ensure host throttling is not triggered under normal pane sizes/FPS defaults.
  - Phase 4: Registry/docs/runtime notes
    - Register both plugin IDs in built-in registry.
    - Update `docs/visualizations.md` and `docs/usage.md` with behavior, limitations, and fallback semantics.
    - Update dependency/license docs if a new package is adopted.
- Acceptance:
  - Both plugins can be selected/cycled and persist via existing visualizer persistence flow.
  - With embedded art available, plugins render bounded output without blocking keyboard transport workflows.
  - Without embedded art, plugins show deterministic fallback text and do not raise.
  - Any plugin failure degrades to `basic` via existing host fallback behavior.
- Tests:
  - Unit tests for artwork extraction helper (image present, no image, invalid image bytes).
  - Unit tests for static render determinism (ANSI on/off, pane resize handling, placeholder states).
  - Unit tests for motion frame progression determinism and effect bounds.
  - Integration tests for plugin registration, visualizer selection persistence, and fallback safety on extraction/render failure.
  - Non-blocking regression tests asserting artwork extraction path is background-threaded.
- Risks / Decisions Needed:
  - New dependency approval may be required for image decoding/resizing (`Pillow`).
  - Embedded artwork size variance can create CPU spikes; cache and frame-budget profiling are required before enabling rotation effects.
  - TinyTag artwork support differs by media container/tag type; fallback messaging must remain explicit and user-friendly.
- Status: `done`

### V3 Visualization Expansion (Extra Scope) — Completed

#### VIZ-001 Matrix Rain Visualizer Plugin
- Spec Ref: `WF-06`, Sections `5`, `6`
- Scope: Add a clean matrix-style code rain visualizer that is non-audio-reactive.
- Acceptance:
  - Plugin renders deterministic falling-code animation with smooth motion at host cadence.
  - Supports at least one green variant; optional blue/red variants exposed as selectable plugin IDs.
  - No keyboard/input starvation while active.
- Tests:
  - Unit tests for frame generation bounds and deterministic seed behavior.
  - Integration test for plugin activation, rendering, and cycling persistence.
- Status: `done`
- Commit: `e016fa0`

#### VIZ-002 Cyberpunk Terminal Ops Visualizer Plugin
- Spec Ref: `WF-06`, Sections `4`, `6`, `8`
- Scope: Add a fictional terminal-operations visualizer themed as staged song “target analysis”.
- Acceptance:
  - Renders staged fictional sequence: surveillance, vulnerability scan, ICE break, account targeting, privilege escalation, data acquisition, decryption, transfer, log cleanup.
  - Stage text is explicitly fictional and non-instructional (movie-style flavor only).
  - Uses current track metadata in output where available (title/artist/album/year).
  - Safe fallback behavior maintained on any render failure.
- Tests:
  - Unit tests for stage progression and metadata interpolation.
  - Integration test to confirm plugin remains non-blocking and survives missing metadata.
- Status: `done`
- Commit: `39ea7fe`

#### VIZ-003 Audio-Reactive VU Meter Visualizer Plugin
- Spec Ref: `WF-06`, Sections `5`, `6`, `9.1`
- Scope: Deliver `vu.reactive` as a service-driven audio-reactive visualizer consuming `AudioLevelService`.
- Acceptance:
  - Meter reflects changing audio energy during playback from effective service source (`live` or `envelope`).
  - UI indicates effective source (`live`/`envelope`/`fallback`) explicitly.
  - Behavior degrades gracefully when no signal source is available (safe fallback mode with no playback interruption).
  - Update cadence remains within host bounds without UI starvation.
- Tests:
  - Unit tests for level normalization, smoothing, clipping, and source label behavior.
  - Integration test with deterministic level provider stub and service source failover.
- Status: `done`
- Commit: `453e715`, `67c0e8f`

#### VIZ-004 Playback-Level Signal Provider Contract
- Spec Ref: Sections `5`, `6`
- Scope: Define and implement `AudioLevelService` provider contract (backend live + envelope cache + fallback).
- Acceptance:
  - Stable interface for obtaining normalized recent level samples (mono or L/R) and effective source ID.
  - Fake backend provides deterministic synthetic levels for tests.
  - VLC live provider remains capability-gated and can safely report unavailable.
  - Service source priority is deterministic: `live` -> `envelope` -> `fallback`.
- Tests:
  - Contract tests for source selection and provider shape/timing expectations.
  - Backend-specific tests for fake live provider and VLC unavailable behavior.
- Status: `done`
- Commit: `453e715`, `22463a9`

#### VIZ-005 Visualizer Catalog and UX Docs
- Spec Ref: Sections `6`, `9`, `11`
- Scope: Document plugin IDs, behavior, limitations, and troubleshooting for new visualizers.
- Acceptance:
  - `docs/visualizations.md` includes behavior/constraints for matrix, terminal-ops, and VU plugins.
  - `docs/usage.md` includes practical notes for choosing and cycling visualizers.
- Tests:
  - N/A (docs), validated by review checklist.
- Status: `done`
- Commit: `66d6195`

#### VIZ-006 Visualizer Acceptance Coverage Update
- Spec Ref: `WF-06`, Section `11`
- Scope: Extend acceptance mapping and release gate notes for added visualizer plugins.
- Acceptance:
  - `docs/workflow-acceptance.md` maps new visualizer tests.
  - Release checklist reflects any environment-gated visualizer checks.
- Tests:
  - N/A (docs), validated by review checklist.
- Status: `done`
- Commit: `66d6195`

#### VIZ-007 PCM Envelope Precompute and Time-Synced VU Source
- Spec Ref: `WF-06`, Sections `5`, `6`, `9.1`
- Scope: Add precomputed PCM level envelopes (timestamped bins) as a backend-agnostic VU signal source.
- Acceptance:
  - Decode/analyze local track audio into normalized time-bucket levels (L/R or mono) and cache by stable track fingerprint.
  - `AudioLevelService` consumes envelope levels synchronized to playback `position_ms` with interpolation and smoothing.
  - Cache invalidates when file fingerprint changes (size/mtime/hash/version key).
  - Fallback remains available when envelope data is missing or analysis fails.
- Tests:
  - Unit tests for envelope generation normalization, bucket alignment, and interpolation.
  - Unit tests for cache hit/miss/invalidation behavior.
  - Integration test proving VU uses envelope source during real playback path (without VLC callbacks).
- Status: `done`
- Commit: `22463a9`, `67c0e8f`, `b8dc538`

#### VIZ-009 FFmpeg External-Only Policy and Runtime Gating
- Spec Ref: Sections `6`, `7`, `9`, `11`
- Scope: Enforce project policy that FFmpeg is never bundled/packaged and is only used when user-installed and discoverable.
- Acceptance:
  - Envelope analysis path remains optional and checks for `ffmpeg` on PATH at runtime.
  - No release/build path attempts to download or bundle FFmpeg binaries.
  - Clear internal policy notes are documented for maintainers and release flow.
- Tests:
  - Unit tests for ffmpeg capability detection and no-ffmpeg fallback behavior.
  - Packaging/release checklist update verifying no bundled external codec binaries.
- Status: `done`
- Commit: `507283b`, `1085e73`, `80b50c6`, `66d6195`

#### VIZ-010 `doctor` Command for Dependency Diagnostics
- Spec Ref: `WF-07`, Sections `9`, `10`, `11`
- Scope: Add a CLI diagnostics command to report backend/tool readiness and remediation guidance.
- Acceptance:
  - Add command: `tz-player doctor`.
  - Reports status for:
    - `python-vlc` import and libVLC availability
    - `ffmpeg` binary discoverability/version
    - metadata reader availability (`tinytag`)
  - Exit code is non-zero when required runtime components for selected backend are missing.
  - Output includes concrete install hints and docs links.
- Tests:
  - CLI tests for success/failure exit codes and key output lines.
  - Unit tests for tool probing functions (mock PATH/process output).
- Status: `done`
- Commit: `1085e73`

#### VIZ-011 UX Wiring for Optional FFmpeg in VU/Envelope Flow
- Spec Ref: Sections `6`, `9`, `10`
- Scope: Surface actionable user messaging when ffmpeg-backed envelope analysis is unavailable.
- Acceptance:
  - Status/diagnostic text clearly indicates when envelope source is unavailable due to missing ffmpeg for non-WAV files.
  - Fallback path remains seamless (no playback interruption, no crashes).
  - Log messages are concise and useful (missing tool vs decode failure).
- Tests:
  - Integration tests for non-WAV track with missing ffmpeg -> fallback source token + messaging.
  - Regression test ensuring WAV analysis still works without ffmpeg.
- Status: `done`
- Commit: `80b50c6`

#### VIZ-012 Docs and Acceptance Mapping for Doctor + FFmpeg Policy
- Spec Ref: `WF-06`, `WF-07`, Section `11`
- Scope: Finalize user/operator docs for external-only ffmpeg usage and diagnostics workflow.
- Acceptance:
  - `docs/usage.md` documents `tz-player doctor` and interpretation.
  - `docs/media-setup.md` references doctor workflow after install.
  - `docs/workflow-acceptance.md` maps new diagnostic/policy tests.
- Tests:
  - N/A (docs), validated by review checklist.
- Status: `done`
- Commit: `66d6195`

#### VIZ-008 Next-Track Envelope Prewarm
- Spec Ref: `WF-06`, Sections `5`, `6`
- Scope: Precompute envelope for the likely next track in the background so VU is ready at track handoff.
- Acceptance:
  - When current track is playing, schedule non-blocking prewarm of predicted next item (respect repeat/shuffle mode).
  - Prewarm job is cancellable/reschedulable on queue changes, seeks, stop, or mode switches.
  - Handoff to next track should use warmed envelope via `AudioLevelService` when available, without UI/event-loop stalls.
- Tests:
  - Unit tests for next-track prediction routing (repeat/shuffle aware).
  - Integration test verifying prewarm completion and envelope availability at transition.
  - Stress test confirming no event-loop blocking under rapid navigation.
- Status: `done`
- Commit: `b8dc538`

#### VIZ-013 Release Guardrails for External Media Tooling
- Spec Ref: Sections `7`, `9`, `11`
- Scope: Add explicit release-time checks that external media binaries (VLC/FFmpeg) are never bundled by project packaging flows.
- Acceptance:
  - Release checklist explicitly verifies that build artifacts do not contain bundled `ffmpeg`/`vlc`/`libvlc` binaries.
  - CI or documented release script includes artifact inspection commands.
  - `README`/docs clearly state external-tool policy at release section.
- Subtasks:
  - Add artifact inspection step(s) to release docs/checklist.
  - Add a simple CI/docs smoke command example to inspect `dist/*` contents.
  - Add troubleshooting note for false positives on platform-specific filenames.
- Tests:
  - N/A (release/docs policy), validated by release checklist execution.
- Status: `done`
- Commit: `0c66d73`

All baseline and stabilization tasks are complete and archived here for traceability.

### P0/P1/P2 Completed
- T-001 Launch and state restore hardening — `done` — `eec7fd9`
- T-002 Playlist navigation determinism — `done` — `7572c70`
- T-003 Playback controls and routing — `done` — `cf04e9d`
- T-004 Find/search focus behavior — `done` — `9d5303a`
- T-005 Playlist editing safety and sync — `done` — `625c4f1`
- T-006 Visualizer registry and host — `done` — `212d61d`
- T-007 Visualizer selection and persistence — `done` — `7db63c5`
- T-008 Runtime config precedence and conflicts — `done` — `b59dbd8`
- T-009 Logging UX and log discoverability — `done` — `f372843`
- T-010 Error message quality pass — `done` — `b0072a9`
- T-011 Non-blocking audit for IO paths — `done` — `f3618a3`
- T-012 Opt-in performance checks — `done` — `38b134a`
- T-013 Crash-safe persistence verification — `done` — `2f64956`
- T-014 Mouse interaction acceptance coverage — `done` — `5e7b9d3`
- T-015 Docs parity and troubleshooting — `done` — `fbfffa4`
- T-016 v1 pre-release sweep — `done` — `ca3bc89`
- T-017 VLC first-track transition hardening (end-of-track advance stability + timing correctness) — `done` — `7a18103`, `6619d42`, `e16884c`, `2d8858a`, `22c5f27`, `daae237`, `56f6527`, `aca36c3`, `3e5b543`, `e0b4727`
- T-018 Visualizer local plugin discovery — `done` — `971efee`, `75a902c`
- T-019 Configurable visualizer FPS — `done` — `c68a30a`, `3fcbb11`
- T-020 Structured logging upgrade — `done` — `cd786cc`, `b17c365`
- T-021 Spec/docs metadata backend parity (TinyTag) — `done` — `8e06f9f`, `057f0c4`
- T-022 Error message quality consistency pass — `done` — `7755b1a`, `df1f448`
- T-023 State file corruption UX surfacing — `done` — `f19b69b`, `bb802c8`
- T-024 Audio level source-switch observability — `done` — `ad9eb5f`, `6d6c11f`
- T-025 Envelope cache miss/populate observability completion — `done` — `21aca99`, `e1ce0a8`
